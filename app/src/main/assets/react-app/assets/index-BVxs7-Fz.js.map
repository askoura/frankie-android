{"version":3,"file":"index-BVxs7-Fz.js","sources":["../../src/pages/manage/Login/index.jsx"],"sourcesContent":["import * as Yup from \"yup\";\nimport { useForm } from \"react-hook-form\";\nimport { yupResolver } from \"@hookform/resolvers/yup\";\n\nimport Link from \"@mui/material/Link\";\nimport Stack from \"@mui/material/Stack\";\nimport Divider from \"@mui/material/Divider\";\nimport IconButton from \"@mui/material/IconButton\";\nimport Typography from \"@mui/material/Typography\";\nimport LoadingButton from \"@mui/lab/LoadingButton\";\nimport InputAdornment from \"@mui/material/InputAdornment\";\nimport { useBoolean } from \"../../../hooks/use-boolean\";\nimport FormProvider, { RHFTextField } from \"../../../components/hook-form\";\nimport Iconify from \"~/components/iconify\";\nimport { useDispatch } from \"react-redux\";\nimport { useNavigate } from \"react-router-dom\";\nimport { setLoading } from \"~/state/edit/editState\";\nimport { GoogleLogin, GoogleOAuthProvider } from \"@react-oauth/google\";\nimport RouterLink from \"~/components/router/router-link\";\nimport { useTranslation } from \"react-i18next\";\nimport { PROCESSED_ERRORS } from \"~/utils/errorsProcessor\";\nimport { routes } from \"~/routes\";\nimport { useService } from \"~/hooks/use-service\";\n\n// ----------------------------------------------------------------------\n\nexport default function LoginView() {\n  const authService = useService(\"auth\");\n\n  const { t } = useTranslation(\"manage\");\n\n  const passwordShow = useBoolean();\n  const dispatch = useDispatch();\n  const navigate = useNavigate();\n\n  const LoginSchema = Yup.object().shape({\n    email: Yup.string()\n      .required(t(\"email_required\"))\n      .email(\"That is not an email\"),\n    password: Yup.string().required(t(\"password_required\")),\n  });\n\n  const defaultValues = {\n    email: \"\",\n    password: \"\",\n  };\n\n  const methods = useForm({\n    resolver: yupResolver(LoginSchema),\n    defaultValues,\n  });\n\n  const {\n    setError,\n    reset,\n    handleSubmit,\n    formState: { isSubmitting },\n  } = methods;\n\n  const handleError = (processedError) => {\n    if (processedError.name == PROCESSED_ERRORS.WRONG_CREDENTIALS.name) {\n      setError(\"email\", {\n        type: \"manual\",\n        message: t(`processed_errors.${processedError.name}`),\n      });\n      setError(\"password\", {\n        type: \"manual\",\n        message: t(`processed_errors.${processedError.name}`),\n      });\n    }\n  };\n\n  const onSubmit = handleSubmit(async (data) => {\n    dispatch(setLoading(true));\n    try {\n      await authService.login(data.email, data.password);\n      const { from } = location.state || { from: { pathname: \"/\" } };\n      navigate(from);\n    } catch (e) {\n      handleError(e);\n    } finally {\n      dispatch(setLoading(false));\n    }\n  });\n\n  const onGoogleAuthSuccess = (credentialResponse) => {\n    dispatch(setLoading(true));\n    authService\n      .googleSignIn(credentialResponse)\n      .then((data) => {\n        const { from } = location.state || { from: { pathname: \"/\" } };\n        navigate(from);\n      })\n      .catch((e) => {\n        handleError(e);\n      })\n      .finally(() => {\n        dispatch(setLoading(false));\n      });\n  };\n\n  const handleGoogleLogin = () => {\n    const clientId = \"YOUR_CLIENT_ID\";\n    const redirectUri = \"YOUR_REDIRECT_URI\";\n    const responseType = \"token\";\n    const scope = \"email profile\";\n    const authUrl = `https://accounts.google.com/o/oauth2/v2/auth?client_id=${clientId}&redirect_uri=${redirectUri}&response_type=${responseType}&scope=${scope}&prompt=consent`;\n\n    window.location.href = authUrl;\n  };\n\n  const renderHead = (\n    <div>\n      <Typography variant=\"h3\" paragraph>\n        {t(\"login.login\")}\n      </Typography>\n\n      <Typography variant=\"body2\" sx={{ color: \"text.secondary\" }}>\n        {t(\"login.dont_have_acc\")}\n        <Link\n          component={RouterLink}\n          href={routes.signup}\n          variant=\"subtitle2\"\n          color=\"primary\"\n        >\n          {\" \"}\n          {t(\"sign_up.get_started\")}\n        </Link>\n      </Typography>\n    </div>\n  );\n\n  const renderSocials = (\n    <Stack direction=\"row\" justifyContent=\"center\">\n      <GoogleOAuthProvider\n        clientId={import.meta.env.VITE_GOOGLE_AUTH_CLIENT_ID}\n      >\n        <GoogleLogin\n          onSuccess={onGoogleAuthSuccess}\n          onError={() => {\n            console.log(\"Login Failed\");\n          }}\n        />\n      </GoogleOAuthProvider>\n    </Stack>\n  );\n\n  const renderForm = (\n    <FormProvider methods={methods} onSubmit={handleSubmit(onSubmit)}>\n      <Stack spacing={2.5} alignItems=\"flex-end\">\n        <RHFTextField name=\"email\" label={t(\"label.email\")} />\n\n        <RHFTextField\n          name=\"password\"\n          label={t(\"label.password\")}\n          type={passwordShow.value ? \"text\" : \"password\"}\n          InputProps={{\n            endAdornment: (\n              <InputAdornment position=\"end\">\n                <IconButton onClick={passwordShow.onToggle} edge=\"end\">\n                  <Iconify\n                    icon={\n                      passwordShow.value ? \"carbon:view\" : \"carbon:view-off\"\n                    }\n                  />\n                </IconButton>\n              </InputAdornment>\n            ),\n          }}\n        />\n\n        <Link\n          component={RouterLink}\n          href=\"/forgot-password\"\n          variant=\"body2\"\n          underline=\"always\"\n          color=\"text.secondary\"\n        >\n          {t(\"login.forgot_password\")}\n        </Link>\n\n        <LoadingButton\n          fullWidth\n          color=\"primary\"\n          size=\"large\"\n          type=\"submit\"\n          variant=\"contained\"\n          loading={isSubmitting}\n        >\n          {t(\"login.login\")}\n        </LoadingButton>\n      </Stack>\n    </FormProvider>\n  );\n\n  return (\n    <>\n      {renderHead}\n\n      {renderForm}\n\n      <Divider>\n        <Typography variant=\"body2\" sx={{ color: \"text.disabled\" }}>\n          or continue with\n        </Typography>\n      </Divider>\n\n      {renderSocials}\n    </>\n  );\n}\n"],"names":["Yup.object","Yup.string","yupResolver","jsx","jsxs","Fragment"],"mappings":"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"}