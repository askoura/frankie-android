{"version":3,"file":"index-806e3ea5.js","sources":["../../src/pages/manage/Login/index.jsx"],"sourcesContent":["import { useState } from \"react\";\nimport { useNavigate, useLocation } from \"react-router-dom\";\nimport { useTranslation } from \"react-i18next\";\nimport {\n  Button,\n  FormControl,\n  IconButton,\n  Input,\n  InputAdornment,\n  InputLabel,\n  TextField,\n  Box,\n  Typography,\n  FormHelperText,\n  Link,\n  Stack,\n} from \"@mui/material\";\nimport { Visibility, VisibilityOff } from \"@mui/icons-material\";\nimport AuthService from \"~/services/AuthService\";\nimport { PROTOCOL } from \"~/constants/networking\";\nimport { AuthWrap } from \"~/components/manage/AuthWrap\";\nimport { FRONT_END_HOST } from \"~/constants/networking\";\nimport { urlWithSubdomain, hostnameSubdomain } from \"~/networking/common\";\nimport styles from \"./Login.module.css\";\nimport { PROCESSED_ERRORS, processError } from \"~/utils/errorsProcessor\";\n\nfunction Login() {\n  const { t, i18n } = useTranslation(\"manage\");\n  const navigate = useNavigate();\n  const location = useLocation();\n  const [loading, setLoading] = useState(false);\n  const [password, setPassword] = useState(\"\");\n  const [passError, setPassError] = useState(\"\");\n  const [email, setEmail] = useState(\"\");\n  const [emailError, setEmailError] = useState(\"\");\n\n  const [showPassword, setShowPassword] = useState(false);\n  const [processedError, setProcessedError] = useState(\"\");\n  const [showError, setShowError] = useState(false);\n  const handleClickShowPassword = () => setShowPassword((show) => !show);\n\n  const validate = () => {\n    setEmailError(\"\");\n    setPassError(\"\");\n    if (email.length == 0) {\n      setEmailError(t(\"email_required\"));\n      return false;\n    }\n    if (password.length == 0) {\n      setPassError(t(\"password_required\"));\n      return false;\n    }\n    return true;\n  };\n\n  const onPasswordChanged = (e) => {\n    setPassword(e.target.value);\n    setPassError(\"\");\n  };\n\n  const onEmailChanged = (e) => {\n    setEmail(e.target.value);\n    setEmailError(\"\");\n  };\n\n  const onSubmit = () => {\n    if (!validate()) {\n      return;\n    }\n    setLoading(true);\n    AuthService.login(email, password)\n      .then((data) => {\n        const subdomain = hostnameSubdomain();\n        if (subdomain === data.subdomain) {\n          const { from } = location.state || { from: { pathname: \"/\" } };\n          navigate(from);\n        } else {\n          if (location.state?.from) {\n            const newUrl =\n              PROTOCOL +\n                \"://\" +\n                data.subdomain +\n                \".\" +\n                FRONT_END_HOST +\n                location.state?.from?.pathname +\n                location.state?.from?.search || \"\";\n            window.location.replace(newUrl);\n          } else {\n            window.location.replace(urlWithSubdomain(data.subdomain));\n          }\n        }\n      })\n      .catch((e) => {\n        const processed = processError(e);\n        switch (processed) {\n          case PROCESSED_ERRORS.NETWORK_ERR:\n          case PROCESSED_ERRORS.BACKEND_DOWN:\n            setShowError(true);\n            setProcessedError(processed);\n            break;\n          case PROCESSED_ERRORS.WRONG_CREDENTIALS:\n            setEmailError(t(`processed_errors.${processed}`));\n            break;\n          default:\n            break;\n        }\n      })\n      .finally(() => {\n        setLoading(false);\n      });\n  };\n\n  return (\n    <AuthWrap\n      loading={loading}\n      showError={showError}\n      processedError={processedError}\n      handleClose={() => setShowError(false)}\n    >\n      <Box className={styles.wrapper}>\n        <Box className={styles.content}>\n          <Typography variant=\"h2\">{t(\"login.title\")}</Typography>\n          <Box className={styles.form}>\n            <TextField\n              onChange={onEmailChanged}\n              error={emailError?.length > 0}\n              value={email}\n              id=\"email\"\n              label={t(\"label.email\")}\n              name=\"email\"\n              required={true}\n              variant=\"standard\"\n            />\n\n            <FormControl required={true} variant=\"standard\" sx={{ mt: \"10px\" }}>\n              <InputLabel htmlFor=\"standard-adornment-password\">\n                {t(\"label.password\")}\n              </InputLabel>\n              <Input\n                error={passError?.length > 0}\n                name=\"password\"\n                value={password}\n                id=\"standard-adornment-password\"\n                type={showPassword ? \"text\" : \"password\"}\n                onChange={onPasswordChanged}\n                endAdornment={\n                  <InputAdornment position=\"end\">\n                    <IconButton\n                      aria-label=\"toggle password visibility\"\n                      onClick={handleClickShowPassword}\n                    >\n                      {showPassword ? <VisibilityOff /> : <Visibility />}\n                    </IconButton>\n                  </InputAdornment>\n                }\n              />\n            </FormControl>\n            {(emailError || passError) && (\n              <FormHelperText className={styles.errorText}>\n                {emailError || passError}\n              </FormHelperText>\n            )}\n            <Stack\n              justifyContent=\"space-between\"\n              flexDirection=\"row\"\n              className={styles.links}\n            >\n              <Link\n                className={styles.link}\n                onClick={() => {\n                  navigate(\"/forgot-password\");\n                }}\n              >\n                {t(\"login.forgot_password\")}\n              </Link>\n              <Link\n                className={styles.link}\n                onClick={() => {\n                  navigate(\"/signup\");\n                }}\n              >\n                {t(\"login.sign_up\")}\n              </Link>\n            </Stack>\n            <Button onClick={onSubmit} sx={{ mt: \"40px\" }}>\n              {t(\"login.submit\")}\n            </Button>\n          </Box>\n        </Box>\n      </Box>\n    </AuthWrap>\n  );\n}\n\nexport default Login;\n"],"names":["useState","jsx","jsxs"],"mappings":"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"}