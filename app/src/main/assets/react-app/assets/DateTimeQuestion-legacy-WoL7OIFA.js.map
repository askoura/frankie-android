{"version":3,"file":"DateTimeQuestion-legacy-WoL7OIFA.js","sources":["../../src/components/Questions/DateTime/DateTimeQuestion.jsx"],"sourcesContent":["import React from \"react\";\nimport TextField from \"@mui/material/TextField\";\nimport { TimePicker } from \"@mui/x-date-pickers/TimePicker\";\nimport { DatePicker } from \"@mui/x-date-pickers/DatePicker\";\nimport { DateTimePicker } from \"@mui/x-date-pickers/DateTimePicker\";\nimport { LocalizationProvider } from \"@mui/x-date-pickers/LocalizationProvider\";\nimport { AdapterDayjs } from \"@mui/x-date-pickers/AdapterDayjs\";\nimport { useDispatch, useSelector, shallowEqual } from \"react-redux\";\nimport dayjs from \"dayjs\";\n\nimport styles from \"./DateTimeQuestion.module.css\";\nimport { useTheme } from \"@mui/system\";\nimport { valueChange } from \"~/state/runState\";\n\nfunction DateTimeQuestion(props) {\n  const theme = useTheme();\n\n  const state = useSelector((state) => {\n    let own = state.runState.values[props.component.qualifiedCode];\n    let show_errors = state.runState.values.Survey.show_errors;\n    let isDirty = state.templateState[props.component.qualifiedCode];\n    return {\n      invalid: (show_errors || isDirty) && own?.validity === false,\n      value: own?.value\n        ? dayjs(window.FrankieScripts.sqlDateTimeToDate(own?.value))\n        : null,\n    };\n  }, shallowEqual);\n  const dispatch = useDispatch();\n\n  const handleDateChange = (date) => {\n    let finalDate = date === null ? undefined : date.toDate();\n    dispatch(\n      valueChange({\n        componentCode: props.component.qualifiedCode,\n\n        value:\n          props.component.type == \"date_time\"\n            ? window.FrankieScripts.toSqlDateTime(finalDate)\n            : props.component.type == \"time\"\n            ? window.FrankieScripts.toSqlDateTimeIgnoreDate(finalDate)\n            : window.FrankieScripts.toSqlDateTimeIgnoreTime(finalDate),\n      })\n    );\n  };\n\n  const dateFormat = props.component.dateFormat\n    ? props.component.dateFormat\n    : \"DD.MM.YYYY\";\n\n  return (\n    <div className={styles.wrapper}>\n      <LocalizationProvider dateAdapter={AdapterDayjs} adapterLocale=\"ar-sa\">\n        {props.component.type == \"date_time\" ? (\n          <DateTimePicker\n            renderInput={(props) => (\n              <TextField onKeyDown={(e) => e.preventDefault()} {...props} />\n            )}\n            margin=\"normal\"\n            value={state.value}\n            inputFormat={\n              dateFormat +\n              \" \" +\n              (props.component.fullDayFormat ? \"HH:mm\" : \"hh:mm A\")\n            }\n            ampm={props.component.fullDayFormat ? false : true}\n            openTo=\"year\"\n            views={[\"year\", \"month\", \"day\", \"hours\", \"minutes\"]}\n            id={props.component.qualifiedCode}\n            minDate={\n              props.component.minDate\n                ? dayjs(\n                    window.FrankieScripts.dateStringToDate(\n                      props.component.minDate\n                    )\n                  )\n                : undefined\n            }\n            maxDate={\n              props.component.maxDate\n                ? dayjs(\n                    window.FrankieScripts.dateStringToDate(\n                      props.component.maxDate\n                    )\n                  )\n                : undefined\n            }\n            error={state.invalid}\n            onChange={handleDateChange}\n            InputProps={{\n              sx: {\n                fontFamily: theme.textStyles.text.font,\n                fontSize: theme.textStyles.text.size,\n                color: theme.textStyles.text.color,\n              },\n            }}\n          />\n        ) : props.component.type == \"time\" ? (\n          <TimePicker\n            renderInput={(params) => (\n              <TextField onKeyDown={(e) => e.preventDefault()} {...params} />\n            )}\n            margin=\"normal\"\n            openTo=\"hours\"\n            views={[\"hours\", \"minutes\"]}\n            ampm={props.component.fullDayFormat ? false : true}\n            inputFormat={props.component.fullDayFormat ? \"HH:mm\" : \"hh:mm A\"}\n            id={props.component.qualifiedCode}\n            value={state.value}\n            error={state.invalid}\n            onChange={handleDateChange}\n            InputProps={{\n              sx: {\n                fontFamily: theme.textStyles.text.font,\n                color: theme.textStyles.text.color,\n                fontSize: theme.textStyles.text.size\n              },\n            }}\n          />\n        ) : (\n          <DatePicker\n            renderInput={(params) => (\n              <TextField onKeyDown={(e) => e.preventDefault()} {...params} />\n            )}\n            margin=\"normal\"\n            openTo=\"year\"\n            views={[\"year\", \"month\", \"day\"]}\n            ampm={props.component.fullDayFormat ? false : true}\n            id={props.component.qualifiedCode}\n            inputFormat={dateFormat}\n            value={state.value}\n            minDate={\n              props.component.minDate\n                ? window.FrankieScripts.dateStringToDate(\n                    props.component.minDate\n                  )\n                : undefined\n            }\n            maxDate={\n              props.component.maxDate\n                ? window.FrankieScripts.dateStringToDate(\n                    props.component.maxDate\n                  )\n                : undefined\n            }\n            error={state.invalid}\n            onChange={handleDateChange}\n            InputProps={{\n              sx: {\n                fontFamily: theme.textStyles.text.font,\n                fontSize: theme.textStyles.text.size,\n              },\n            }}\n          />\n        )}\n      </LocalizationProvider>\n    </div>\n  );\n}\n\nexport default DateTimeQuestion;\n"],"names":["DateTimeQuestion","props","theme","useTheme","state","useSelector","own","runState","values","component","qualifiedCode","show_errors","Survey","isDirty","templateState","invalid","validity","value","dayjs","window","FrankieScripts","sqlDateTimeToDate","shallowEqual","dispatch","useDispatch","handleDateChange","date","finalDate","toDate","valueChange","componentCode","type","toSqlDateTime","toSqlDateTimeIgnoreDate","toSqlDateTimeIgnoreTime","dateFormat","jsx","className","styles","wrapper","children","LocalizationProvider","dateAdapter","AdapterDayjs","adapterLocale","DateTimePicker","renderInput","TextField","_objectSpread","onKeyDown","e","preventDefault","margin","inputFormat","fullDayFormat","ampm","openTo","views","id","minDate","dateStringToDate","maxDate","error","onChange","InputProps","sx","fontFamily","textStyles","text","font","fontSize","size","color","TimePicker","params","DatePicker"],"mappings":"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"}